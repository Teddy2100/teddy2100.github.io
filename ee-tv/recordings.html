<style is="custom-style">
 div.recording{max-width:530px;max-height:340px;width:530px;height:340px;}
 div.recording{background-size:cover;position:relative;box-sizing:border-box;}
 div.recording{font-family:'NobbleeLight','Roboto',sans-serif!important;cursor:pointer;}
 div.recording{display:inline-block;margin:8px;border-radius:8px;border:2px solid var(--ee-front);}
 div.fader{width:100%;height:100%;background:linear-gradient(to bottom,rgba(0,0,0,0.00) 60%,rgba(0,0,0,0.75) 90%);} 
 div.fader p{position:absolute;left:0px;right:0px;bottom:0px;margin:0px;font-size:40px;padding:5px 10px;} 
 div.fader{border-bottom-right-radius:6px;border-bottom-left-radius:6px;box-sizing:border-box;} 
 div.fader p{white-space:nowrap;overflow:hidden;text-overflow: ellipsis;}
 @media screen and (max-width:640px){
  div.recording{width:340px;height:220px;}
  div.fader p{font-size:25px;}
 }
</style>
<center id="uiContainer">
 LOADING
</center>
<script>
console.log("RECORDINGS LOADED");
$("#uiContainer").empty();//CLEAN CONTAINER
 
var ajaxrunner=$.getJSON(urls("recordings"),function(recording_data){
 var pvrlist={},sorted=[];$.each(recording_data,function(key,json){
  var program=json.event.name?json.event.name:"error getting program name";
  var programimg=json.event.icon?json.event.icon:urls("")+json.event.image;
  if(!pvrlist[program]){pvrlist[program]={image:programimg,items:[]};sorted.push(program);}  
  pvrlist[program].items[pvrlist[program].items.length]=json;sorted.sort();
 });

 $.each(sorted,function(k,name){var data=pvrlist[name];
  var fader=$("<div/>").addClass("fader").html("<p>"+name.toUpperCase()+"</p>");
  var holder=$("<div/>").css("background-image","url("+data.image+")").addClass("recording");
   holder.on("click",function(obj){showRecordings(data);})
  $("#uiContainer").append(holder.append(fader));
 });
   
 /*$("#mainContainer").append("<hr>");
 $.each(recording_data,function(k,json){var card=$("<ee-recording><span>TEST</span></ee-recording>"); 
  card.attr("src",json.event.icon?json.event.icon:"http://"+useip+json.event.image);
  card.attr("title",json.event.name).attr("video",json.id);
  //card.append("<span>TEST</span>");
  $("#mainContainer").append(card).toast();
 });*/
}).error(function(){
 alert("ERROR CONNECTING");
});

function showRecordings(obj){
 if(obj.items.length!=1){alert('SERIES');}else{
  $.get(urls("play_recording")+obj.items[0].id,function(){
   $().toast({text:"PLAYING: "+obj.items[0].name});
  });
 }
}
</script>